# Configuration

Complete guide to configuring SED.

## Configuration File

SED looks for configuration in the following locations (in order):

1. File specified by `--config` option
2. `.sedrc.json` in project root
3. `.sedrc.yaml` or `.sedrc.yml`
4. `sed.config.js` or `sed.config.ts`
5. `sed` field in `package.json`

## Configuration Options

### include

**Type:** `string[]`  
**Default:** `['**/*']`

Glob patterns for files to include in analysis.

```json
{
  "include": [
    "src/**/*.ts",
    "lib/**/*.js",
    "packages/*/src/**/*.ts"
  ]
}
```

### exclude

**Type:** `string[]`  
**Default:** `['**/node_modules/**', '**/*.test.*', '**/__tests__/**']`

Glob patterns for files to exclude from analysis.

```json
{
  "exclude": [
    "**/node_modules/**",
    "**/*.test.ts",
    "**/*.spec.ts",
    "**/fixtures/**",
    "**/dist/**"
  ]
}
```

### thresholds

**Type:** `Thresholds`  
**Default:** `{ trivial: 0.5, low: 1.5, medium: 3.0, high: 4.5 }`

Entropy thresholds for classification.

```json
{
  "thresholds": {
    "trivial": 0.3,
    "low": 1.0,
    "medium": 2.5,
    "high": 4.0
  }
}
```

### nodeWeights

**Type:** `Record<string, number>`  
**Default:** See [default weights](/guide/concepts#node-type-weight)

Custom weights for AST node types.

```json
{
  "nodeWeights": {
    "FunctionDeclaration": 4.0,
    "ClassDeclaration": 5.0,
    "MethodDefinition": 3.0,
    "TestCase": 0.5
  }
}
```

### contextRules

**Type:** `ContextRule[]`  
**Default:** `[]`

Rules that adjust entropy based on file context.

```json
{
  "contextRules": [
    {
      "pattern": "**/security/**",
      "factor": 2.0,
      "name": "Security-critical files"
    },
    {
      "pattern": "**/*.test.ts",
      "factor": 0.5,
      "name": "Test files"
    },
    {
      "pattern": "**/migrations/**",
      "factor": 1.5,
      "name": "Database migrations"
    }
  ]
}
```

### output

**Type:** `OutputConfig`

Default output configuration.

```json
{
  "output": {
    "format": "text",
    "colors": true,
    "verbose": false,
    "showChanges": true,
    "maxFiles": 50
  }
}
```

### failOn

**Type:** `Classification | 'never'`  
**Default:** `'never'`

Classification level that causes CLI to exit with error.

```json
{
  "failOn": "high"
}
```

### parsers

**Type:** `Record<string, ParserConfig>`

Custom parser configuration.

```json
{
  "parsers": {
    "typescript": {
      "jsx": true,
      "decorators": true
    },
    "python": {
      "version": 3
    }
  }
}
```

## Configuration Formats

### JSON (.sedrc.json)

```json
{
  "include": ["src/**/*.ts"],
  "exclude": ["**/*.test.ts"],
  "thresholds": {
    "trivial": 0.5,
    "low": 1.5,
    "medium": 3.0,
    "high": 4.5
  }
}
```

### YAML (.sedrc.yaml)

```yaml
include:
  - src/**/*.ts
  
exclude:
  - '**/*.test.ts'
  
thresholds:
  trivial: 0.5
  low: 1.5
  medium: 3.0
  high: 4.5
```

### JavaScript (sed.config.js)

```javascript
/** @type {import('@sed/cli').Config} */
module.exports = {
  include: ['src/**/*.ts'],
  exclude: ['**/*.test.ts'],
  thresholds: {
    trivial: 0.5,
    low: 1.5,
    medium: 3.0,
    high: 4.5,
  },
};
```

### TypeScript (sed.config.ts)

```typescript
import { defineConfig } from '@sed/cli';

export default defineConfig({
  include: ['src/**/*.ts'],
  exclude: ['**/*.test.ts'],
  thresholds: {
    trivial: 0.5,
    low: 1.5,
    medium: 3.0,
    high: 4.5,
  },
});
```

### package.json

```json
{
  "name": "my-project",
  "sed": {
    "include": ["src/**/*.ts"],
    "thresholds": {
      "high": 4.0
    }
  }
}
```

## Environment-Specific Configuration

Use different configurations for different environments:

```typescript
// sed.config.ts
import { defineConfig } from '@sed/cli';

export default defineConfig(({ mode }) => ({
  include: ['src/**/*.ts'],
  
  // Stricter thresholds in CI
  thresholds: mode === 'ci' 
    ? { trivial: 0.3, low: 1.0, medium: 2.0, high: 3.5 }
    : { trivial: 0.5, low: 1.5, medium: 3.0, high: 4.5 },
    
  // Fail on high in CI, never locally
  failOn: mode === 'ci' ? 'high' : 'never',
}));
```

## Extending Configurations

Extend from a base configuration:

```json
{
  "extends": "@company/sed-config",
  "include": ["src/**/*.ts"],
  "thresholds": {
    "high": 4.0
  }
}
```

## Validation

Validate your configuration:

```bash
sed config validate
```

## Complete Example

```json
{
  "include": [
    "src/**/*.ts",
    "packages/*/src/**/*.ts"
  ],
  "exclude": [
    "**/node_modules/**",
    "**/*.test.ts",
    "**/*.spec.ts",
    "**/dist/**",
    "**/coverage/**"
  ],
  "thresholds": {
    "trivial": 0.5,
    "low": 1.5,
    "medium": 3.0,
    "high": 4.5
  },
  "nodeWeights": {
    "FunctionDeclaration": 3.0,
    "ClassDeclaration": 4.0,
    "MethodDefinition": 2.5
  },
  "contextRules": [
    {
      "pattern": "**/security/**",
      "factor": 2.0
    },
    {
      "pattern": "**/*.test.ts",
      "factor": 0.5
    }
  ],
  "output": {
    "format": "text",
    "colors": true,
    "verbose": false
  },
  "failOn": "never"
}
```

## See Also

- [CLI Usage](/cli/)
- [Core Concepts](/guide/concepts)
- [Thresholds](/guide/thresholds)
